M:\Sysc 2003\Assignment 3\Assign31.lst - generated by MGTEK Assembler ASM12 V1.26 Build 144 for WIN32 (x86) - Tue Feb 26 22:18:47 2013

    1:                                 ;**********************************************
    2:                                 ;Fady Ibrahim
    3:                                 ;100876906
    4:                                 ;February 26 2013
    5:                                 ;**********************************************
    6:                                 
    7:          =00001000                              ORG     $1000                   ;data area
    8:                                 
    9:                                 ;Strings to display obstacle and path.
   10:     1000 4F 62 73 74 61 63      msgObstacleY:           FCC     "Obstacle near by!"             ;string: display message
           1006 6C 65 20 6E 65 61 
           100C 72 20 62 79 21 
   11:     1011 00                     TerminateString5        DB      0
   12:     1012 4E 6F 20 6F 62 73      msgObstacleN:           FCC     "No obstacle near by!"          ;string: display message
           1018 74 61 63 6C 65 20 
           101E 6E 65 61 72 20 62 
           1024 79 21 
   13:     1026 00                     TerminateString6        DB      0
   14:     1027 20 20 44 69 72 65      msgNorth:               FCC     "  Direction North!  "          ;string: display message
           102D 63 74 69 6F 6E 20 
           1033 4E 6F 72 74 68 21 
           1039 20 20 
   15:     103B 00                     TerminateString7        DB      0
   16:     103C 20 20 44 69 72 65      msgSouth:               FCC     "  Direction South!  "          ;string: display message
           1042 63 74 69 6F 6E 20 
           1048 53 6F 75 74 68 21 
           104E 20 20 
   17:     1050 00                     TerminateString8        DB      0
   18:     1051 20 20 44 69 72 65      msgEast:                FCC     "  Direction East!   "          ;string: display message
           1057 63 74 69 6F 6E 20 
           105D 45 61 73 74 21 20 
           1063 20 20 
   19:     1065 00                     TerminateString9        DB      0
   20:     1066 20 20 44 69 72 65      msgWest:                FCC     "  Direction West!   "          ;string: display message
           106C 63 74 69 6F 6E 20 
           1072 57 65 73 74 21 20 
           1078 20 20 
   21:     107A 00                     TerminateString10       DB      0
   22:     107B 20 20 44 69 72 65      msgNorthEast:           FCC     "  Direction NorthEast!   "             ;string: display message
           1081 63 74 69 6F 6E 20 
           1087 4E 6F 72 74 68 45 
           108D 61 73 74 21 20 20 
           1093 20 
   23:     1094 00                     TerminateString11       DB      0
   24:     1095 20 20 44 69 72 65      msgNorthWest:           FCC     "  Direction NorthWest!   "             ;string: display message
           109B 63 74 69 6F 6E 20 
           10A1 4E 6F 72 74 68 57 
           10A7 65 73 74 21 20 20 
           10AD 20 
   25:     10AE 00                     TerminateString12       DB      0
   26:     10AF 20 20 44 69 72 65      msgSouthEast:           FCC     "  Direction SouthEast!   "             ;string: display message
           10B5 63 74 69 6F 6E 20 
           10BB 53 6F 75 74 68 45 
           10C1 61 73 74 21 20 20 
           10C7 20 
   27:     10C8 00                     TerminateString13       DB      0
   28:     10C9 20 20 44 69 72 65      msgSouthWest:           FCC     "  Direction SouthWest!   "             ;string: display message
           10CF 63 74 69 6F 6E 20 
           10D5 53 6F 75 74 68 57 
           10DB 65 73 74 21 20 20 
           10E1 20 
   29:     10E2 00                     TerminateString14       DB      0
   30:                                 
   31:                                 
   32:                                 ;offests to index into the stack
   33:          =00000008              localspeed              equ     8
   34:          =00000009              localTemperature        equ     9
   35:          =0000000A              localProximity          equ     10      
   36:          =0000000C              localKeys               equ     12
   37:                                 
   38:                                 ;a general counter used for to shift a byte or word data
   39:     10E3 +0001                  counter:                rmb     1
   40:     10E4 07                     copycounter1            db      7
   41:     10E5 0F                     copycounter2            db      15
   42:     10E6 00                     Compare:                db      00
   43:                                 
   44:                                 ;prints out the variable name then the binary value of that variable.
   45:     10E7 53 70 65 65 64 3A      msgSpeed:               FCC     "Speed:"                ;string: display message
   46:     10ED +0008                  speedStr:               ds.b    8
   47:     10F5 00                     TerminateString1        DB      0
   48:     10F6 54 65 6D 70 65 72      msgTemp:                FCC     "Temperature:"          ;string: display message
           10FC 61 74 75 72 65 3A 
   49:     1102 +0008                  TemperatureStr:         ds.b    8
   50:     110A 00                     TerminateString2        DB      0
   51:     110B 50 72 6F 78 69 6D      msgProx:                FCC     "Proximity:"            ;string: display message
           1111 69 74 79 3A 
   52:     1115 00                     TerminateString3        DB      0               
   53:     1116 4B 65 79 73 50 72      msgKeys:                FCC     "KeysPresed:"           ;string: display message
           111C 65 73 65 64 3A 
   54:     1121 +0010                  KeyPressedStr           ds.w    8
   55:     1131 00                     TerminateString4        DB      0
   56:                                 
   57:                                 
   58:                                 
   59:                                 ;variables
   60:     1132 +0001                  Speed                   rmb     1
   61:     1133 +0001                  Temperature             rmb     1
   62:     1134 +0002                  Proximity               rmw     1
   63:     1136 +0002                  KeyPressed              rmw     1
   64:     1138 +0001                  boolResult:             rmb     1
   65:                                 
   66:          =00004000                              ORG     $4000                   ;program area                           
   67:     4000                        start:
   68:     4000 CF 3DFF                                        LDS     #$3DFF                  ;initialize stack pointer (details later)
   69:                                 
   70:     4003 CC 001A                                        LDD     #BAUD19K                ;program SCI0's baud rate
   71:     4006 16 4038                                        JSR     setbaud
   72:                                 
   73:                                                         ;initialize the variables
   74:     4009 86 34                                          lDA     #$34
   75:     400B 7A 1132                                        STAA    Speed
   76:     400E C6 12                                          LDB     #18
   77:     4010 7B 1133                                        STAB    Temperature
   78:     4013 CC 2897                                        LDD     #%0010100010010111
   79:     4016 7C 1134                                        STD     Proximity
   80:     4019 CE EFFF                                        LDX     #$EFFF
   81:     401C 7E 1136                                        STX     KeyPressed
   82:                                                         ;store the variables on the stack
   83:     401F CE 1136                                        LDX     #KeyPressed
   84:     4022 34                                             PSHX
   85:     4023 FD 1134                                        LDY     Proximity
   86:     4026 35                                             pshy
   87:     4027 B6 1133                                        lda     Temperature
   88:     402A 36                                             psha
   89:     402B F6 1132                                        ldb     Speed
   90:     402E 37                                             pshb
   91:     402F 16 4064                                        jsr     displaySystemStatus ;call the subroutine displaySystemStatus
   92:     4032 33                                             pulb
   93:     4033 32                                             pula
   94:     4034 31                                             puly
   95:     4035 30                                             pulx
   96:     4036 20 FE                                          BRA *
   97:                                                         
   98:                                 #include "DP256reg.asm"
    1:                                 *
    2:                                 *
    3:                                 *  Define HC12 I/O register locations (9S12DP256)
    4:                                 *
    5:          =00000000              REGBS           EQU $0000    ; DP256 register bank base address
    6:                                 
    7:          =00000000              PORTA:          EQU REGBS+0   ;port A = Address lines A8 - A15
    8:          =00000001              PORTB:          EQU REGBS+1   ;port B = Address lines A0 - A7
    9:          =00000002              DDRA:           EQU REGBS+2   ;port A direction register
   10:          =00000003              DDRB:           EQU REGBS+3   ;port A direction register
   11:                                 
   12:          =00000008              PORTE:          EQU REGBS+8   ;port E = mode,IRQandcontrolsignals
   13:          =00000009              DDRE:           EQU REGBS+9   ;port E direction register
   14:          =0000000A              PEAR:           EQU REGBS+$A  ;port E assignments
   15:          =0000000B              MODE:           EQU REGBS+$B  ;Mode register
   16:          =0000000C              PUCR:           EQU REGBS+$C  ;port pull-up control register
   17:          =0000000D              RDRIV:          EQU REGBS+$D  ;port reduced drive control register
   18:          =0000000E              EBICTL:         EQU REGBS+$E  ;E stretch control
   19:                                 
   20:          =00000010              INITRM:         EQU REGBS+$10 ;Ram location register
   21:          =00000011              INITRG:         EQU REGBS+$11 ;Register location register
   22:          =00000012              INITEE:         EQU REGBS+$12 ;EEprom location register
   23:          =00000013              MISC:           EQU REGBS+$13 ;Miscellaneous Mapping control
   24:          =00000014              MTST0:          EQU REGBS+$14 ; RESERVED
   25:          =00000015              ITCR:           EQU REGBS+$15 ;Interrupt test control register
   26:          =00000016              ITEST:          EQU REGBS+$16 ;Interrupt test register
   27:          =00000017              MTST1:          EQU REGBS+$17 ; Reserved
   28:                                 
   29:          =0000001A              PARTIDH:        EQU REGBS+$1A ;Part ID high
   30:          =0000001B              PARTIDL:        EQU REGBS+$1B ;Part ID low
   31:          =0000001C              MEMSIZ0:        EQU REGBS+$1C ;memory size
   32:          =0000001D              MEMSIZ1:        EQU REGBS+$1D ;memory size
   33:          =0000001E              INTCR:          EQU REGBS+$1E ;interrupt control register
   34:          =0000001F              HPRIO:          EQU REGBS+$1F ;high priority reg
   35:                                 
   36:          =00000028              BKPCT0:         EQU REGBS+$28 ;Break control register
   37:          =00000029              BKPCT1:         EQU REGBS+$29 ;Break control register
   38:          =0000002A              BKP0X:          EQU REGBS+$2A ; Break 0 index register
   39:          =0000002B              BKP0H:          EQU REGBS+$2B ; Break 0 pointer high
   40:          =0000002C              BRP0L:          EQU REGBS+$2C ; Break 0 pointer low
   41:          =0000002D              BKP1X:          EQU REGBS+$2D ; Break 1 index register
   42:          =0000002E              BKP1H:          EQU REGBS+$2E ; Break 1 pointer high
   43:          =0000002F              BRP1L:          EQU REGBS+$2F ; Break 1 pointer low
   44:          =00000030              PPAGE:          EQU REGBS+$30 ;Program Page register
   45:                                 
   46:          =00000032              PORTK:          EQU REGBS+$32 ;Port K data
   47:          =00000033              DDRK:           EQU REGBS+$33 ;Port K direction
   48:          =00000034              SYNR:           EQU REGBS+$34 ; Synthesizer / multiplier register
   49:          =00000035              REFDV:          EQU REGBS+$35 ; Reference divider register
   50:          =00000036              CTFLG:          EQU REGBS+$36 ; RESERVED
   51:          =00000037              CRGFLG:         EQU REGBS+$37 ; PLL flags register
   52:          =00000038              CRGINT:         EQU REGBS+$38 ; PLL interrupt register
   53:          =00000039              CLKSEL:         EQU REGBS+$39 ; Clock select register
   54:          =0000003A              PLLCTL:         EQU REGBS+$3A ; PLL control register
   55:          =0000003B              RTICTL:         EQU REGBS+$3B ;Real time interrupt control
   56:          =0000003C              COPCTL:         EQU REGBS+$3C ;Watchdog control
   57:          =0000003D              FORBYP:         EQU REGBS+$3D ;
   58:          =0000003E              CTCTL:          EQU REGBS+$3E ;
   59:          =0000003F              ARMCOP:         EQU REGBS+$3F ;COP reset register
   60:                                 
   61:          =00000040              TIOS:           EQU REGBS+$40 ;timer input/output select
   62:          =00000041              CFORC:          EQU REGBS+$41 ;timer compare force
   63:          =00000042              OC7M:           EQU REGBS+$42 ;timer output compare 7 mask
   64:          =00000043              OC7D:           EQU REGBS+$43 ;timer output compare 7 data
   65:          =00000044              TCNT:           EQU REGBS+$44 ;timer counter register hi
   66:                                 *TCNT:          EQU REGBS+$45 ;timer counter register lo
   67:          =00000046              TSCR:           EQU REGBS+$46 ;timer system control register
   68:          =00000047              TTOV:           EQU REGBS+$47 ;reserved
   69:          =00000048              TCTL1:          EQU REGBS+$48 ;timer control register 1
   70:          =00000049              TCTL2:          EQU REGBS+$49 ;timer control register 2
   71:          =0000004A              TCTL3:          EQU REGBS+$4A ;timer control register 3
   72:          =0000004B              TCTL4:          EQU REGBS+$4B ;timer control register 4
   73:          =0000004C              TMSK1:          EQU REGBS+$4C ;timer interrupt mask 1
   74:          =0000004D              TMSK2:          EQU REGBS+$4D ;timer interrupt mask 2
   75:          =0000004E              TFLG1:          EQU REGBS+$4E ;timer flags 1
   76:          =0000004F              TFLG2:          EQU REGBS+$4F ;timer flags 2
   77:          =00000050              TC0:            EQU REGBS+$50 ;timer capture/compare register 0
   78:                                 *TC0:           EQU REGBS+$51 ;
   79:          =00000052              TC1:            EQU REGBS+$52 ;timer capture/compare register 1
   80:                                 *TC1:           EQU REGBS+$53 ;
   81:          =00000054              TC2:            EQU REGBS+$54 ;timer capture/compare register 2
   82:                                 *TC2:           EQU REGBS+$55 ;
   83:          =00000056              TC3:            EQU REGBS+$56 ;timer capture/compare register 3
   84:                                 *TC3:           EQU REGBS+$57 ;
   85:          =00000058              TC4:            EQU REGBS+$58 ;timer capture/compare register 4
   86:                                 *TC4:           EQU REGBS+$59 ;
   87:          =0000005A              TC5:            EQU REGBS+$5A ;timer capture/compare register 5
   88:                                 *TC5:           EQU REGBS+$5B ;
   89:          =0000005C              TC6:            EQU REGBS+$5C ;timer capture/compare register 6
   90:                                 *TC6:           EQU REGBS+$5D ;
   91:          =0000005E              TC7:            EQU REGBS+$5E ;timer capture/compare register 7
   92:                                 *TC7:           EQU REGBS+$5F ;
   93:          =00000060              PACTL:          EQU REGBS+$60 ;pulse accumulator controls
   94:          =00000061              PAFLG:          EQU REGBS+$61 ;pulse accumulator flags
   95:          =00000062              PACN3:          EQU REGBS+$62 ;pulse accumulator counter 3
   96:          =00000063              PACN2:          EQU REGBS+$63 ;pulse accumulator counter 2
   97:          =00000064              PACN1:          EQU REGBS+$64 ;pulse accumulator counter 1
   98:          =00000065              PACN0:          EQU REGBS+$65 ;pulse accumulator counter 0
   99:          =00000066              MCCTL:          EQU REGBS+$66 ;Modulus down conunter control
  100:          =00000067              MCFLG:          EQU REGBS+$67 ;down counter flags
  101:          =00000068              ICPAR:          EQU REGBS+$68 ;Input pulse accumulator control
  102:          =00000069              DLYCT:          EQU REGBS+$69 ;Delay count to down counter
  103:          =0000006A              ICOVW:          EQU REGBS+$6A ;Input control overwrite register
  104:          =0000006B              ICSYS:          EQU REGBS+$6B ;Input control system control
  105:                                 
  106:          =0000006D              TIMTST:         EQU REGBS+$6D ;timer test register
  107:                                 
  108:          =00000070              PBCTL:          EQU REGBS+$70 ; Pulse accumulator B control
  109:          =00000071              PBFLG:          EQU REGBS+$71 ; Pulse accumulator B flags
  110:          =00000072              PA3H:           EQU REGBS+$72 ; Pulse Accumulator holding register 3
  111:          =00000073              PA2H:           EQU REGBS+$73 ; Pulse Accumulator holding register 2
  112:          =00000074              PA1H:           EQU REGBS+$74 ; Pulse Accumulator holding register 1
  113:          =00000075              PA0H:           EQU REGBS+$75 ; Pulse Accumulator holding register 0
  114:          =00000076              MCCNT:          EQU REGBS+$76 ; Modulus down counter register
  115:                                 *MCCNTL:        EQU REGBS+$77 ; low byte
  116:          =00000078              TCOH:           EQU REGBS+$78 ; Capture 0 holding register
  117:          =0000007A              TC1H:           EQU REGBS+$7A ; Capture 1 holding register
  118:          =0000007C              TC2H:           EQU REGBS+$7C ; Capture 2 holding register
  119:          =0000007E              TC3H:           EQU REGBS+$7E ; Capture 3 holding register
  120:                                 
  121:          =00000080              ATD0CTL0:       EQU REGBS+$80 ;ADC control 0 (reserved)
  122:          =00000081              ATD0CTL1:       EQU REGBS+$81 ;ADC control 1 (reserved)
  123:          =00000082              ATD0CTL2:       EQU REGBS+$82 ;ADC control 2
  124:          =00000083              ATD0CTL3:       EQU REGBS+$83 ;ADC control 3
  125:          =00000084              ATD0CTL4:       EQU REGBS+$84 ;ADC control 4
  126:          =00000085              ATD0CTL5:       EQU REGBS+$85 ;ADC control 5
  127:          =00000086              ATD0STAT:       EQU REGBS+$86 ;ADC status register hi
  128:                                 *ATD0STAT       EQU REGBS+$87 ;ADC status register lo
  129:          =00000088              ATD0TEST:       EQU REGBS+$88 ;ADC test (reserved)
  130:                                 *ATD0TEST       EQU REGBS+$89 ;
  131:                                 
  132:          =0000008D              ATD0DIEN:       EQU REGBS+$8D ;
  133:                                 
  134:          =0000008F              PORTAD:         EQU REGBS+$8F ;port ADC = input only
  135:          =00000090              ADR00H:         EQU REGBS+$90 ;ADC result 0 register
  136:          =00000092              ADR01H:         EQU REGBS+$92 ;ADC result 1 register
  137:          =00000094              ADR02H:         EQU REGBS+$94 ;ADC result 2 register
  138:          =00000096              ADR03H:         EQU REGBS+$96 ;ADC result 3 register
  139:          =00000098              ADR04H:         EQU REGBS+$98 ;ADC result 4 register
  140:          =0000009A              ADR05H:         EQU REGBS+$9A ;ADC result 5 register
  141:          =0000009C              ADR06H:         EQU REGBS+$9C ;ADC result 6 register
  142:          =0000009E              ADR07H:         EQU REGBS+$9E ;ADC result 7 register
  143:                                 
  144:          =000000A0              PWME:           EQU REGBS+$A0 ;PWM enable
  145:          =000000A1              PWMPOL:         EQU REGBS+$A1 ;PWM polarity
  146:          =000000A2              PWMCLK:         EQU REGBS+$A2 ;PWM clock select register
  147:          =000000A3              PWMPRCLK:       EQU REGBS+$A3 ;PWM Prescale clock select register
  148:          =000000A4              PWMCAE:         EQU REGBS+$A4 ;PWM center align select register
  149:          =000000A5              PWMCTL:         EQU REGBS+$A5 ;PWM control register
  150:          =000000A6              PWMTST:         EQU REGBS+$A6 ;reserved
  151:          =000000A7              PWMPRSC:        EQU REGBS+$A7 ;reserved
  152:          =000000A8              PWMSCLA:        EQU REGBS+$A8 ;PWM Scale A
  153:          =000000A9              PWMSCLB:        EQU REGBS+$A9 ;PWM scale B
  154:          =000000AA              PWMSCNTA:       EQU REGBS+$AA ;reserved
  155:          =000000AB              PWMSCNTB:       EQU REGBS+$AB ;reserved
  156:          =000000AC              PWMCNT0:        EQU REGBS+$AC ;PWM channel 0 counter
  157:          =000000AD              PWMCNT1:        EQU REGBS+$AD ;PWM channel 1 counter
  158:          =000000AE              PWMCNT2:        EQU REGBS+$AE ;PWM channel 2 counter
  159:          =000000AF              PWMCNT3:        EQU REGBS+$AF ;PWM channel 3 counter
  160:          =000000B0              PWMCNT4:        EQU REGBS+$B0 ;PWM channel 4 counter
  161:          =000000B1              PWMCNT5:        EQU REGBS+$B1 ;PWM channel 5 counter
  162:          =000000B2              PWMCNT6:        EQU REGBS+$B2 ;PWM channel 6 counter
  163:          =000000B3              PWMCNT7:        EQU REGBS+$B3 ;PWM channel 7 counter
  164:          =000000B4              PWMPER0:        EQU REGBS+$B4 ;PWM channel 0 period
  165:          =000000B5              PWMPER1:        EQU REGBS+$B5 ;PWM channel 1 period
  166:          =000000B6              PWMPER2:        EQU REGBS+$B6 ;PWM channel 2 period
  167:          =000000B7              PWMPER3:        EQU REGBS+$B7 ;PWM channel 3 period
  168:          =000000B8              PWMPER4:        EQU REGBS+$B8 ;PWM channel 4 period
  169:          =000000B9              PWMPER5:        EQU REGBS+$B9 ;PWM channel 5 period
  170:          =000000BA              PWMPER6:        EQU REGBS+$BA ;PWM channel 6 period
  171:          =000000BB              PWMPER7:        EQU REGBS+$BB ;PWM channel 7 period
  172:          =000000BC              PWMDTY0:        EQU REGBS+$BC ;PWM channel 0 duty cycle
  173:          =000000BD              PWMDTY1:        EQU REGBS+$BD ;PWM channel 1 duty cycle
  174:          =000000BE              PWMDTY2:        EQU REGBS+$BE ;PWM channel 2 duty cycle
  175:          =000000BF              PWMDTY3:        EQU REGBS+$BF ;PWM channel 3 duty cycle
  176:          =000000C0              PWMDTY4:        EQU REGBS+$C0 ;PWM channel 0 duty cycle
  177:          =000000C1              PWMDTY5:        EQU REGBS+$C1 ;PWM channel 1 duty cycle
  178:          =000000C2              PWMDTY6:        EQU REGBS+$C2 ;PWM channel 2 duty cycle
  179:          =000000C3              PWMDTY7:        EQU REGBS+$C3 ;PWM channel 3 duty cycle
  180:          =000000C4              PWMSDN:         EQU REGBS+$C4 ;PWM shutdown register
  181:                                 
  182:          =000000C8              SC0BDH:         EQU REGBS+$C8 ;sci 0 baud reg hi byte
  183:          =000000C9              SC0BDL:         EQU REGBS+$C9 ;sci 0 baud reg lo byte
  184:          =000000CA              SC0CR1:         EQU REGBS+$CA ;sci 0 control1 reg
  185:          =000000CB              SC0CR2:         EQU REGBS+$CB ;sci 0 control2 reg
  186:          =000000CC              SC0SR1:         EQU REGBS+$CC ;sci 0 status reg 1
  187:          =000000CD              SC0SR2:         EQU REGBS+$CD ;sci 0 status reg 2
  188:          =000000CE              SC0DRH:         EQU REGBS+$CE ;sci 0 data reg hi
  189:          =000000CF              SC0DRL:         EQU REGBS+$CF ;sci 0 data reg lo
  190:          =000000D0              SC1BDH:         EQU REGBS+$D0 ;sci 1 baud reg hi byte
  191:          =000000D1              SC1BDL:         EQU REGBS+$D1 ;sci 1 baud reg lo byte
  192:          =000000D2              SC1CR1:         EQU REGBS+$D2 ;sci 1 control1 reg
  193:          =000000D3              SC1CR2:         EQU REGBS+$D3 ;sci 1 control2 reg
  194:          =000000D4              SC1SR1:         EQU REGBS+$D4 ;sci 1 status reg 1
  195:          =000000D5              SC1SR2:         EQU REGBS+$D5 ;sci 1 status reg 2
  196:          =000000D6              SC1DRH:         EQU REGBS+$D6 ;sci 1 data reg hi
  197:          =000000D7              SC1DRL:         EQU REGBS+$D7 ;sci 1 data reg lo
  198:          =000000D8              SPI0CR1:        EQU REGBS+$D8 ;spi 0 control1 reg
  199:          =000000D9              SPI0CR2:        EQU REGBS+$D9 ;spi 0 control2 reg
  200:          =000000DA              SPI0BR:         EQU REGBS+$DA ;spi 0 baud reg
  201:          =000000DB              SPI0SR:         EQU REGBS+$DB ;spi 0 status reg hi
  202:                                 
  203:          =000000DD              SP0DR:          EQU REGBS+$DD ;spi 0 data reg
  204:                                 
  205:          =000000E0              IBAD:           EQU REGBS+$E0 ;I2C Bus address register
  206:          =000000E1              IBFD:           EQU REGBS+$E1 ;I2C Bus frequency divider
  207:          =000000E2              IBCR:           EQU REGBS+$E2 ;I2C Bus control register
  208:          =000000E3              IBSR:           EQU REGBS+$E3 ;I2C Bus status register
  209:          =000000E4              IBDR:           EQU REGBS+$E4 ;I2C Bus message data register
  210:                                 
  211:          =000000E8              DLCBCR1:        EQU REGBS+$E8 ;BDLC Control regsiter 1
  212:          =000000E9              DLCBSVR:        EQU REGBS+$E9 ;BDLC State vector register
  213:          =000000EA              DLCBCR2:        EQU REGBS+$EA ;BDLC Control register 2
  214:          =000000EB              DLCBDR:         EQU REGBS+$EB ;BDLC Data register
  215:          =000000EC              DLCBARD:        EQU REGBS+$EC ;BDLC Analog delay register
  216:          =000000ED              DLCBRSR:        EQU REGBS+$ED ;BDLC Rate select register
  217:          =000000EE              DLCSCR:         EQU REGBS+$EE ;BDLC Control register
  218:          =000000EF              DLCBSTAT:       EQU REGBS+$EF ;BDLC Status register
  219:          =000000F0              SPI1CR1:        EQU REGBS+$F0 ;spi 1 control1 reg
  220:          =000000F1              SPI1CR2:        EQU REGBS+$F1 ;spi 1 control2 reg
  221:          =000000F2              SPI1BR:         EQU REGBS+$F2 ;spi 1 baud reg
  222:          =000000F3              SPI1SR:         EQU REGBS+$F3 ;spi 1 status reg hi
  223:                                 
  224:          =000000F5              SP1DR:          EQU REGBS+$F5 ;spi 1 data reg
  225:                                 
  226:          =000000F8              SPI2CR1:        EQU REGBS+$F8 ;spi 2 control1 reg
  227:          =000000F9              SPI2CR2:        EQU REGBS+$F9 ;spi 2 control2 reg
  228:          =000000FA              SPI2BR:         EQU REGBS+$FA ;spi 2 baud reg
  229:          =000000FB              SPI2SR:         EQU REGBS+$FB ;spi 2 status reg hi
  230:                                 
  231:          =000000FD              SP2DR:          EQU REGBS+$FD ;spi 2 data reg
  232:                                 
  233:          =00000100              FCLKDIV:        EQU REGBS+$100 ;FLASH clock divider
  234:          =00000101              FSEC:           EQU REGBS+$101 ;FLASH security register
  235:                                 
  236:          =00000103              FCNFG:          EQU REGBS+$103 ;FLASH configuration register
  237:          =00000104              FPROT:          EQU REGBS+$104 ;FLASH protection register
  238:          =00000105              FSTAT:          EQU REGBS+$105 ;FLASH status register
  239:          =00000106              FCMD:           EQU REGBS+$106 ;FLASH command register
  240:                                 
  241:          =00000110              ECLKDIV:        EQU REGBS+$110 ;EEPROM clock divider
  242:                                 
  243:          =00000113              ECNFG:          EQU REGBS+$113 ;EEPROM configuration register
  244:          =00000114              EPROT:          EQU REGBS+$114 ;EEPROM protection register
  245:          =00000115              ESTAT:          EQU REGBS+$115 ;EEPROM status register
  246:          =00000116              ECMD:           EQU REGBS+$116 ;EEPROM command register
  247:                                 
  248:          =00000120              ATD1CTL0:       EQU REGBS+$120 ;ADC1 control 0 (reserved)
  249:          =00000121              ATD1CTL1:       EQU REGBS+$121 ;ADC1 control 1 (reserved)
  250:          =00000122              ATD1CTL2:       EQU REGBS+$122 ;ADC1 control 2
  251:          =00000123              ATD1CTL3:       EQU REGBS+$123 ;ADC1 control 3
  252:          =00000124              ATD1CTL4:       EQU REGBS+$124 ;ADC1 control 4
  253:          =00000125              ATD1CTL5:       EQU REGBS+$125 ;ADC1 control 5
  254:          =00000126              ATD1STAT:       EQU REGBS+$126 ;ADC1 status register hi
  255:                                 *ATD1STAT       EQU REGBS+$127 ;ADC1 status register lo
  256:          =00000128              ATD1TEST:       EQU REGBS+$128 ;ADC1 test (reserved)
  257:                                 *ATD1TEST       EQU REGBS+$129 ;
  258:                                 
  259:          =0000012D              ATDDIEN:        EQU REGBS+$12D ;ADC1 INPUT ENABLE REGISTER
  260:                                 
  261:          =0000012F              PORTAD1:        EQU REGBS+$12F ;port ADC1 = input only
  262:          =00000130              ADR10H:         EQU REGBS+$130 ;ADC1 result 0 register
  263:          =00000132              ADR11H:         EQU REGBS+$132 ;ADC1 result 1 register ADR12H:         EQU REGBS+$134 ;ADC1 result 2 register
  264:          =00000136              ADR13H:         EQU REGBS+$136 ;ADC1 result 3 register
  265:          =00000138              ADR14H:         EQU REGBS+$138 ;ADC1 result 4 register
  266:          =0000013A              ADR15H:         EQU REGBS+$13A ;ADC1 result 5 register
  267:          =0000013C              ADR16H:         EQU REGBS+$13C ;ADC1 result 6 register
  268:          =0000013E              ADR17H:         EQU REGBS+$13E ;ADC1 result 7 register
  269:          =00000140              CAN0CTL0:       EQU REGBS+$140 ;CAN0 control register 0
  270:          =00000141              CAN0CTL1:       EQU REGBS+$141 ;CAN0 control register 1
  271:          =00000142              CAN0BTR0:       EQU REGBS+$142 ;CAN0 bus timing register 0
  272:          =00000143              CAN0BTR1:       EQU REGBS+$143 ;CAN0 bus timing register 1
  273:          =00000144              CAN0RFLG:       EQU REGBS+$144 ;CAN0 receiver flags
  274:          =00000145              CAN0RIER:       EQU REGBS+$145 ;CAN0 receiver interrupt enables
  275:          =00000146              CAN0TFLG:       EQU REGBS+$146 ;CAN0 transmit flags
  276:          =00000147              CAN0TIER:       EQU REGBS+$147 ;CAN0 transmit interrupt enables
  277:          =00000148              CAN0TARQ:       EQU REGBS+$148 ;CAN0 transmit message abort control
  278:          =00000149              CAN0TAAK:       EQU REGBS+$149 ;CAN0 transmit message abort status
  279:          =0000014A              CAN0TBEL:       EQU REGBS+$14A ;CAN0 transmit buffer select
  280:          =0000014B              CAN0IDAC:       EQU REGBS+$14B ;CAN0 identfier acceptance control
  281:                                 
  282:          =0000014E              CAN0RERR:       EQU REGBS+$14E ;CAN0 Receive error counter
  283:          =0000014F              CAN0TERR:       EQU REGBS+$14F ;CAN0 Transmit error counter
  284:          =00000150              CAN0IDA0:       EQU REGBS+$150 ;CAN0 Identifier acceptance register 0
  285:          =00000151              CAN0IDA1:       EQU REGBS+$151 ;CAN0 Identifier acceptance register 1
  286:          =00000152              CAN0IDA2:       EQU REGBS+$152 ;CAN0 Identifier acceptance register 2
  287:          =00000153              CAN0IDA3:       EQU REGBS+$153 ;CAN0 Identifier acceptance register 3
  288:          =00000154              CAN0IDM0:       EQU REGBS+$154 ;CAN0 Identifier mask register 0
  289:          =00000155              CAN0IDM1:       EQU REGBS+$155 ;CAN0 Identifier mask register 1
  290:          =00000156              CAN0IDM2:       EQU REGBS+$156 ;CAN0 Identifier mask register 2
  291:          =00000157              CAN0IDM3:       EQU REGBS+$157 ;CAN0 Identifier mask register 3
  292:          =00000158              CAN0IDA4:       EQU REGBS+$158 ;CAN0 Identifier acceptance register 4
  293:          =00000159              CAN0IDA5:       EQU REGBS+$159 ;CAN0 Identifier acceptance register 5
  294:          =0000015A              CAN0IDA6:       EQU REGBS+$15A ;CAN0 Identifier acceptance register 6
  295:          =0000015B              CAN0IDA7:       EQU REGBS+$15B ;CAN0 Identifier acceptance register 7
  296:          =0000015C              CAN0IDM4:       EQU REGBS+$15C ;CAN0 Identifier mask register 4
  297:          =0000015D              CAN0IDM5:       EQU REGBS+$15D ;CAN0 Identifier mask register 5
  298:          =0000015E              CAN0IDM6:       EQU REGBS+$15E ;CAN0 Identifier mask register 6
  299:          =0000015F              CAN0IDM7:       EQU REGBS+$15F ;CAN0 Identifier mask register 7
  300:          =00000160              CAN0RXFG:       EQU REGBS+$160 ;CAN0 RX foreground buffer thru +$16F
  301:          =00000170              CAN0TXFG:       EQU REGBS+$170 ;CAN0 TX foreground buffer thru +$17F
  302:                                 
  303:          =00000180              CAN1CTL0:       EQU REGBS+$180 ;CAN1 control register 0
  304:          =00000181              CAN1CTL1:       EQU REGBS+$181 ;CAN1 control register 1
  305:          =00000182              CAN1BTR0:       EQU REGBS+$182 ;CAN1 bus timing register 0
  306:          =00000183              CAN1BTR1:       EQU REGBS+$183 ;CAN1 bus timing register 1
  307:          =00000184              CAN1RFLG:       EQU REGBS+$184 ;CAN1 receiver flags
  308:          =00000185              CAN1RIER:       EQU REGBS+$185 ;CAN1 receiver interrupt enables
  309:          =00000186              CAN1TFLG:       EQU REGBS+$186 ;CAN1 transmit flags
  310:          =00000187              CAN1TIER:       EQU REGBS+$187 ;CAN1 transmit interrupt enables
  311:          =00000188              CAN1TARQ:       EQU REGBS+$188 ;CAN1 transmit message abort control
  312:          =00000189              CAN1TAAK:       EQU REGBS+$189 ;CAN1 transmit message abort status
  313:          =0000018A              CAN1TBEL:       EQU REGBS+$18A ;CAN1 transmit buffer select
  314:          =0000018B              CAN1IDAC:       EQU REGBS+$18B ;CAN1 identfier acceptance control
  315:                                 
  316:          =0000018E              CAN1RERR:       EQU REGBS+$18E ;CAN1 Receive error counter
  317:          =0000018F              CAN1TERR:       EQU REGBS+$18F ;CAN1 Transmit error counter
  318:          =00000190              CAN1IDA0:       EQU REGBS+$190 ;CAN1 Identifier acceptance register 0
  319:          =00000191              CAN1IDA1:       EQU REGBS+$191 ;CAN1 Identifier acceptance register 1
  320:          =00000192              CAN1IDA2:       EQU REGBS+$192 ;CAN1 Identifier acceptance register 2
  321:          =00000193              CAN1IDA3:       EQU REGBS+$193 ;CAN1 Identifier acceptance register 3
  322:          =00000194              CAN1IDM0:       EQU REGBS+$194 ;CAN1 Identifier mask register 0
  323:          =00000195              CAN1IDM1:       EQU REGBS+$195 ;CAN1 Identifier mask register 1
  324:          =00000196              CAN1IDM2:       EQU REGBS+$196 ;CAN1 Identifier mask register 2
  325:          =00000197              CAN1IDM3:       EQU REGBS+$197 ;CAN1 Identifier mask register 3
  326:          =00000198              CAN1IDA4:       EQU REGBS+$198 ;CAN1 Identifier acceptance register 4
  327:          =00000199              CAN1IDA5:       EQU REGBS+$199 ;CAN1 Identifier acceptance register 5
  328:          =0000019A              CAN1IDA6:       EQU REGBS+$19A ;CAN1 Identifier acceptance register 6
  329:          =0000019B              CAN1IDA7:       EQU REGBS+$19B ;CAN1 Identifier acceptance register 7
  330:          =0000019C              CAN1IDM4:       EQU REGBS+$19C ;CAN1 Identifier mask register 4
  331:          =0000019D              CAN1IDM5:       EQU REGBS+$19D ;CAN1 Identifier mask register 5
  332:          =0000019E              CAN1IDM6:       EQU REGBS+$19E ;CAN1 Identifier mask register 6
  333:          =0000019F              CAN1IDM7:       EQU REGBS+$19F ;CAN1 Identifier mask register 7
  334:          =000001A0              CAN1RXFG:       EQU REGBS+$1A0 ;CAN1 RX foreground buffer thru +$1AF
  335:          =000001B0              CAN1TXFG:       EQU REGBS+$1B0 ;CAN1 TX foreground buffer thru +$1BF
  336:                                 
  337:          =000001C0              CAN2CTL0:       EQU REGBS+$1C0 ;CAN2 control register 0
  338:          =000001C1              CAN2CTL1:       EQU REGBS+$1C1 ;CAN2 control register 1
  339:          =000001C2              CAN2BTR0:       EQU REGBS+$1C2 ;CAN2 bus timing register 0
  340:          =000001C3              CAN2BTR1:       EQU REGBS+$1C3 ;CAN2 bus timing register 1
  341:          =000001C4              CAN2RFLG:       EQU REGBS+$1C4 ;CAN2 receiver flags
  342:          =000001C5              CAN2RIER:       EQU REGBS+$1C5 ;CAN2 receiver interrupt enables
  343:          =000001C6              CAN2TFLG:       EQU REGBS+$1C6 ;CAN2 transmit flags
  344:          =000001C7              CAN2TIER:       EQU REGBS+$1C7 ;CAN2 transmit interrupt enables
  345:          =000001C8              CAN2TARQ:       EQU REGBS+$1C8 ;CAN2 transmit message abort control
  346:          =000001C9              CAN2TAAK:       EQU REGBS+$1C9 ;CAN2 transmit message abort status
  347:          =000001CA              CAN2TBEL:       EQU REGBS+$1CA ;CAN2 transmit buffer select
  348:          =000001CB              CAN2IDAC:       EQU REGBS+$1CB ;CAN2 identfier acceptance control
  349:                                 
  350:          =000001CE              CAN2RERR:       EQU REGBS+$1CE ;CAN2 Receive error counter
  351:          =000001CF              CAN2TERR:       EQU REGBS+$1CF ;CAN2 Transmit error counter
  352:          =000001D0              CAN2IDA0:       EQU REGBS+$1D0 ;CAN2 Identifier acceptance register 0
  353:          =000001D1              CAN2IDA1:       EQU REGBS+$1D1 ;CAN2 Identifier acceptance register 1
  354:          =000001D2              CAN2IDA2:       EQU REGBS+$1D2 ;CAN2 Identifier acceptance register 2
  355:          =000001D3              CAN2IDA3:       EQU REGBS+$1D3 ;CAN2 Identifier acceptance register 3
  356:          =000001D4              CAN2IDM0:       EQU REGBS+$1D4 ;CAN2 Identifier mask register 0
  357:          =000001D5              CAN2IDM1:       EQU REGBS+$1D5 ;CAN2 Identifier mask register 1
  358:          =000001D6              CAN2IDM2:       EQU REGBS+$1D6 ;CAN2 Identifier mask register 2
  359:          =000001D7              CAN2IDM3:       EQU REGBS+$1D7 ;CAN2 Identifier mask register 3
  360:          =000001D8              CAN2IDA4:       EQU REGBS+$1D8 ;CAN2 Identifier acceptance register 4
  361:          =000001D9              CAN2IDA5:       EQU REGBS+$1D9 ;CAN2 Identifier acceptance register 5
  362:          =000001DA              CAN2IDA6:       EQU REGBS+$1DA ;CAN2 Identifier acceptance register 6
  363:          =000001DB              CAN2IDA7:       EQU REGBS+$1DB ;CAN2 Identifier acceptance register 7
  364:          =000001DC              CAN2IDM4:       EQU REGBS+$1DC ;CAN2 Identifier mask register 4
  365:          =000001DD              CAN2IDM5:       EQU REGBS+$1DD ;CAN2 Identifier mask register 5
  366:          =000001DE              CAN2IDM6:       EQU REGBS+$1DE ;CAN2 Identifier mask register 6
  367:          =000001DF              CAN2IDM7:       EQU REGBS+$1DF ;CAN2 Identifier mask register 7
  368:          =000001E0              CAN2RXFG:       EQU REGBS+$1E0 ;CAN2 RX foreground buffer thru +$1EF
  369:          =000001F0              CAN2TXFG:       EQU REGBS+$1F0 ;CAN2 TX foreground buffer thru +$1FF
  370:                                 
  371:          =00000200              CAN3CTL0:       EQU REGBS+$200 ;CAN3 control register 0
  372:          =00000201              CAN3CTL1:       EQU REGBS+$201 ;CAN3 control register 1
  373:          =00000202              CAN3BTR0:       EQU REGBS+$202 ;CAN3 bus timing register 0
  374:          =00000203              CAN3BTR1:       EQU REGBS+$203 ;CAN3 bus timing register 1
  375:          =00000204              CAN3RFLG:       EQU REGBS+$204 ;CAN3 receiver flags
  376:          =00000205              CAN3RIER:       EQU REGBS+$205 ;CAN3 receiver interrupt enables
  377:          =00000206              CAN3TFLG:       EQU REGBS+$206 ;CAN3 transmit flags
  378:          =00000207              CAN3TIER:       EQU REGBS+$207 ;CAN3 transmit interrupt enables
  379:          =00000208              CAN3TARQ:       EQU REGBS+$208 ;CAN3 transmit message abort control
  380:          =00000209              CAN3TAAK:       EQU REGBS+$209 ;CAN3 transmit message abort status
  381:          =0000020A              CAN3TBEL:       EQU REGBS+$20A ;CAN3 transmit buffer select
  382:          =0000020B              CAN3IDAC:       EQU REGBS+$20B ;CAN3 identfier acceptance control
  383:                                 
  384:          =0000020E              CAN3RERR:       EQU REGBS+$20E ;CAN3 Receive error counter
  385:          =0000020F              CAN3TERR:       EQU REGBS+$20F ;CAN3 Transmit error counter
  386:          =00000210              CAN3IDA0:       EQU REGBS+$210 ;CAN3 Identifier acceptance register 0
  387:          =00000211              CAN3IDA1:       EQU REGBS+$211 ;CAN3 Identifier acceptance register 1
  388:          =00000212              CAN3IDA2:       EQU REGBS+$212 ;CAN3 Identifier acceptance register 2
  389:          =00000213              CAN3IDA3:       EQU REGBS+$213 ;CAN3 Identifier acceptance register 3
  390:          =00000214              CAN3IDM0:       EQU REGBS+$214 ;CAN3 Identifier mask register 0
  391:          =00000215              CAN3IDM1:       EQU REGBS+$215 ;CAN3 Identifier mask register 1
  392:          =00000216              CAN3IDM2:       EQU REGBS+$216 ;CAN3 Identifier mask register 2
  393:          =00000217              CAN3IDM3:       EQU REGBS+$217 ;CAN3 Identifier mask register 3
  394:          =00000218              CAN3IDA4:       EQU REGBS+$218 ;CAN3 Identifier acceptance register 4
  395:          =00000219              CAN3IDA5:       EQU REGBS+$219 ;CAN3 Identifier acceptance register 5
  396:          =0000021A              CAN3IDA6:       EQU REGBS+$21A ;CAN3 Identifier acceptance register 6
  397:          =0000021B              CAN3IDA7:       EQU REGBS+$21B ;CAN3 Identifier acceptance register 7
  398:          =0000021C              CAN3IDM4:       EQU REGBS+$21C ;CAN3 Identifier mask register 4
  399:          =0000021D              CAN3IDM5:       EQU REGBS+$21D ;CAN3 Identifier mask register 5
  400:          =0000021E              CAN3IDM6:       EQU REGBS+$21E ;CAN3 Identifier mask register 6
  401:          =0000021F              CAN3IDM7:       EQU REGBS+$21F ;CAN3 Identifier mask register 7
  402:          =00000220              CAN3RXFG:       EQU REGBS+$220 ;CAN3 RX foreground buffer thru +$22F
  403:          =00000230              CAN3TXFG:       EQU REGBS+$230 ;CAN3 TX foreground buffer thru +$23F
  404:                                 
  405:          =00000240              PTT:            EQU REGBS+$240 ;portT data register
  406:          =00000241              PTIT:           EQU REGBS+$241 ;portT input register
  407:          =00000242              DDRT:           EQU REGBS+$242 ;portT direction register
  408:          =00000243              RDRT:           EQU REGBS+$243 ;portT reduced drive register
  409:          =00000244              PERT:           EQU REGBS+$244 ;portT pull device enable
  410:          =00000245              PPST:           EQU REGBS+$245 ;portT pull polarity select
  411:                                 
  412:          =00000248              PTS:            EQU REGBS+$248 ;portS data register
  413:          =00000249              PTIS:           EQU REGBS+$249 ;portS input register
  414:          =0000024A              DDRS:           EQU REGBS+$24A ;portS direction register
  415:          =0000024B              RDRS:           EQU REGBS+$24B ;portS reduced drive register
  416:          =0000024C              PERS:           EQU REGBS+$24C ;portS pull device enable
  417:          =0000024D              PPSS:           EQU REGBS+$24D ;portS pull polarity select
  418:          =0000024E              WOMS:           EQU REGBS+$24E ;portS Wired Or mode register
  419:                                 
  420:          =00000250              PTM:            EQU REGBS+$250 ;portM data register
  421:          =00000251              PTIM:           EQU REGBS+$251 ;portM input register
  422:          =00000252              DDRM:           EQU REGBS+$252 ;portM direction register
  423:          =00000253              RDRM:           EQU REGBS+$253 ;portM reduced drive register
  424:          =00000254              PERM:           EQU REGBS+$254 ;portM pull device enable
  425:          =00000255              PPSM:           EQU REGBS+$255 ;portM pull polarity select
  426:          =00000256              WOMM:           EQU REGBS+$256 ;portM Wired Or mode register
  427:          =00000257              MODRR:          EQU REGBS+$257 ;portM Module routing register
  428:          =00000258              PTP:            EQU REGBS+$258 ;portP data register
  429:          =00000259              PTIP:           EQU REGBS+$259 ;portP input register
  430:          =0000025A              DDRP:           EQU REGBS+$25A ;portP direction register
  431:          =0000025B              RDRP:           EQU REGBS+$25B ;portP reduced drive register
  432:          =0000025C              PERP:           EQU REGBS+$25C ;portP pull device enable
  433:          =0000025D              PPSP:           EQU REGBS+$25D ;portP pull polarity select
  434:          =0000025E              PIEP:           EQU REGBS+$25E ;portP interrupt enable register
  435:          =0000025F              PIFP:           EQU REGBS+$25F ;portP interrupt flag register
  436:          =00000260              PTH:            EQU REGBS+$260 ;portH data register
  437:          =00000261              PTIH:           EQU REGBS+$261 ;portH input register
  438:          =00000262              DDRH:           EQU REGBS+$262 ;portH direction register
  439:          =00000263              RDRH:           EQU REGBS+$263 ;portH reduced drive register
  440:          =00000264              PERH:           EQU REGBS+$264 ;portH pull device enable
  441:          =00000265              PPSH:           EQU REGBS+$265 ;portH pull polarity select
  442:          =00000266              PIEH:           EQU REGBS+$266 ;portH interrupt enable register
  443:          =00000267              PIFH:           EQU REGBS+$267 ;portH interrupt flag register
  444:          =00000268              PTJ:            EQU REGBS+$268 ;portP data register
  445:          =00000269              PTIJ:           EQU REGBS+$269 ;portP input register
  446:          =0000026A              DDRJ:           EQU REGBS+$26A ;portP direction register
  447:          =0000026B              RDRJ:           EQU REGBS+$26B ;portP reduced drive register
  448:          =0000026C              PERJ:           EQU REGBS+$26C ;portP pull device enable
  449:          =0000026D              PPSJ:           EQU REGBS+$26D ;portP pull polarity select
  450:          =0000026E              PIEJ:           EQU REGBS+$26E ;portP interrupt enable register
  451:          =0000026F              PIFJ:           EQU REGBS+$26F ;portP interrupt flag register
  452:                                 
  453:          =00000280              CAN4CTL0:       EQU REGBS+$280 ;CAN4 control register 0
  454:          =00000281              CAN4CTL1:       EQU REGBS+$281 ;CAN4 control register 1
  455:          =00000282              CAN4BTR0:       EQU REGBS+$282 ;CAN4 bus timing register 0
  456:          =00000283              CAN4BTR1:       EQU REGBS+$283 ;CAN4 bus timing register 1
  457:          =00000284              CAN4RFLG:       EQU REGBS+$284 ;CAN4 receiver flags
  458:          =00000285              CAN4RIER:       EQU REGBS+$285 ;CAN4 receiver interrupt enables
  459:          =00000286              CAN4TFLG:       EQU REGBS+$286 ;CAN4 transmit flags
  460:          =00000287              CAN4TIER:       EQU REGBS+$287 ;CAN4 transmit interrupt enables
  461:          =00000288              CAN4TARQ:       EQU REGBS+$288 ;CAN4 transmit message abort control
  462:          =00000289              CAN4TAAK:       EQU REGBS+$289 ;CAN4 transmit message abort status
  463:          =0000028A              CAN4TBEL:       EQU REGBS+$28A ;CAN4 transmit buffer select
  464:          =0000028B              CAN4IDAC:       EQU REGBS+$28B ;CAN4 identfier acceptance control
  465:                                 
  466:          =0000028E              CAN4RERR:       EQU REGBS+$28E ;CAN4 Receive error counter
  467:          =0000028F              CAN4TERR:       EQU REGBS+$28F ;CAN4 Transmit error counter
  468:          =00000290              CAN4IDA0:       EQU REGBS+$290 ;CAN4 Identifier acceptance register 0
  469:          =00000291              CAN4IDA1:       EQU REGBS+$291 ;CAN4 Identifier acceptance register 1
  470:          =00000292              CAN4IDA2:       EQU REGBS+$292 ;CAN4 Identifier acceptance register 2
  471:          =00000293              CAN4IDA3:       EQU REGBS+$293 ;CAN4 Identifier acceptance register 3
  472:          =00000294              CAN4IDM0:       EQU REGBS+$294 ;CAN4 Identifier mask register 0
  473:          =00000295              CAN4IDM1:       EQU REGBS+$295 ;CAN4 Identifier mask register 1
  474:          =00000296              CAN4IDM2:       EQU REGBS+$296 ;CAN4 Identifier mask register 2
  475:          =00000297              CAN4IDM3:       EQU REGBS+$297 ;CAN4 Identifier mask register 3
  476:          =00000298              CAN4IDA4:       EQU REGBS+$298 ;CAN4 Identifier acceptance register 4
  477:          =00000299              CAN4IDA5:       EQU REGBS+$299 ;CAN4 Identifier acceptance register 5
  478:          =0000029A              CAN4IDA6:       EQU REGBS+$29A ;CAN4 Identifier acceptance register 6
  479:          =0000029B              CAN4IDA7:       EQU REGBS+$29B ;CAN4 Identifier acceptance register 7
  480:          =0000029C              CAN4IDM4:       EQU REGBS+$29C ;CAN4 Identifier mask register 4
  481:          =0000029D              CAN4IDM5:       EQU REGBS+$29D ;CAN4 Identifier mask register 5
  482:          =0000029E              CAN4IDM6:       EQU REGBS+$29E ;CAN4 Identifier mask register 6
  483:          =0000029F              CAN4IDM7:       EQU REGBS+$29F ;CAN4 Identifier mask register 7
  484:          =000002A0              CAN4RXFG:       EQU REGBS+$2A0 ;CAN4 RX foreground buffer thru +$2AF
  485:          =000002B0              CAN4TXFG:       EQU REGBS+$2B0 ;CAN4 TX foreground buffer thru +$2BF
  486:                                 
  487:                                 * End registers
   99:                                 #include "sci0api.asm"                  
    1:                                 ;******************************************************************************************************
    2:                                 ;SCI0 Routines - Lloyd Atkinson, Nov 2003
    3:                                 ;******************************************************************************************************
    4:                                 
    5:                                 ;Note: Simulator automatically matches to any baud rate
    6:          =00000034              BAUD9600        EQU     0052    ;9600 Divider  (8MHz ECLK) Used for Mon12
    7:          =0000001A              BAUD19K         EQU     0026    ;19200 Divider (8MHz ECLK) Used for NoICE
    8:                                 
    9:                                 ;***********************************************************************
   10:                                 ;void setbaud(int baudRate)
   11:                                 ;
   12:                                 ;Sets up SCI0 with baud rate specified in D
   13:                                 ;Sets up SC0CR1 with Wakeup By Address Mark and Long Idle Time enabled
   14:                                 ;Enables Receiver & Transmitter
   15:                                 ;***********************************************************************
   16:                                 
   17:     4038                        setbaud:
   18:                                         ;Setup SCI for receive
   19:                                                 ;Set Baud Rate
   20:     4038 5A C8                                  staa SC0BDH
   21:     403A 5B C9                                  stab SC0BDL
   22:                                                 ;Setup SC0CR1 with Wakeup By Address Mark and Long Idle Time enabled
   23:     403C 180B 0C 00CA                           movb #$0C, SC0CR1
   24:                                                 ;Enable Receiver&Transmitter
   25:     4041 4C CB 0C                               bset SC0CR2, #$0C
   26:     4044 3D                             rts
   27:                                 
   28:                                 ;*********************************************************************************
   29:     4045                        putStr_sc0: 
   30:                                 ;Accepts: Start address of output string in Y
   31:                                 ;Returns: Nothing
   32:                                 ;Destroys: Nothing
   33:                                 ;Given a start address in Y, outputs string until 
   34:                                 ;it finds null, it does not ouput the null
   35:                                 ;*********************************************************************************
   36:     4045 3B                             pshd
   37:                                 
   38:                                         ;Init Counter
   39:     4046 86 00                          ldaa #0
   40:     4048                        PutStr: 
   41:                                         ;Get character
   42:     4048 E6 EC                          ldab A, Y
   43:                                         ;Put Character
   44:     404A 16 4056                        jsr putChar_sc0
   45:                                         ;Test for Done
   46:     404D C1 00                          cmpb #0
   47:     404F 27 03                          beq DonePutStr
   48:                                                 ;Not done yet
   49:     4051 42                                     inca
   50:     4052 20 F4                                  bra PutStr
   51:                                 
   52:     4054                        DonePutStr:
   53:     4054 3A                             puld
   54:     4055 3D                             rts
   55:                                         
   56:                                 ;*********************************************************************************
   57:     4056                        putChar_sc0: 
   58:                                 ;Accepts: Character for output in B
   59:                                 ;Returns: Nothing
   60:                                 ;Destroys: Nothing
   61:                                 ;Given a character in B, polls 'Transmit Data Register Empty Flag'(TDRE) of SC0SR1
   62:                                 ;until it goes high.  Then places new character in SC0DRL data register for output
   63:                                 ;*********************************************************************************      
   64:                                         ;If SC0SR1 Bit 7 is high then we may write another byte for output
   65:     4056 4F CC 80 FC                    brclr SC0SR1, #$80, putChar_sc0
   66:                                         ;Write next character to the Data Register
   67:     405A 5B CF                          stab SC0DRL
   68:     405C 3D                             rts
   69:                                 
   70:                                 
   71:                                 ;*********************************************************************************
   72:     405D                        getChar_sc0: 
   73:                                 ;Accepts: Nothing
   74:                                 ;Returns: Input character from SCI0
   75:                                 ;Destroys: B
   76:                                 ;Polls 'Receive Data Register Flag' (RDRF) of SC0SR1 until it goes high.
   77:                                 ;Then places new character from SC0DRL in B
   78:                                 ;*********************************************************************************      
   79:                                         ;If SC0SR1 Bit 5 is high, there is a new character in SC0DRL
   80:     405D 4F CC 20 FC                    brclr SC0SR1, #$20, getChar_sc0
   81:                                         ;Read in new character from the Data Register
   82:     4061 D6 CF                          ldab SC0DRL
   83:     4063 3D                             rts
  100:                                                         
  101:                                 
  102:                                                         
  103:                                                         
  104:                                 
  105:                                 ;**********************************************
  106:                                 ;displaySystemStatus Routine
  107:                                 ;prints variable names and their value
  108:                                 ;**********************************************
  109:     4064                        displaySystemStatus:
  110:     4064 3B                                             pshd    
  111:     4065 34                                             pshx
  112:     4066 35                                             pshy
  113:                                 
  114:     4067                        SpeedDisp:
  115:                                                         ;initializes counter and register y to be taken by Display
  116:     4067 C6 08                                          ldb     #8
  117:     4069 7B 10E3                                        stab    counter ;sets the variable
  118:     406C F6 10E4                                        ldb     copycounter1
  119:     406F CD 10ED                                        ldy     #speedstr
  120:     4072 19ED                                           ABY     
  121:     4074 E6 88                                          ldb     localspeed,sp   ;index into the stack
  122:     4076 86 00                                          lda     #$00            ;clears a
  123:     4078 16 413B                                        jsr     Display
  124:     407B                        TempratureDisp          
  125:                                                         
  126:                                                         ;initializes counter and register y to be taken by Display
  127:     407B C6 08                                          ldb     #8
  128:     407D 7B 10E3                                        stab    counter
  129:     4080 F6 10E4                                        ldb     copycounter1
  130:     4083 CD 1102                                        ldy     #Temperaturestr
  131:     4086 19ED                                           ABY     
  132:     4088 E6 89                                          ldb     localTemperature,sp
  133:     408A 86 00                                          lda     #$00
  134:     408C 16 413B                                        jsr     Display
  135:     408F                        ProximityDisp:
  136:                                                         ;check to see if there is first an object near by or not.
  137:     408F CD 110B                                        LDY     #msgProx                ;output Prox the message
  138:     4092 16 4045                                        JSR     putStr_sc0
  139:                                 
  140:     4095 0E 8A 80 02                                    BRSET   localProximity,sp,$80,Collision ;branches if the msb is set to 1 else branch to no collision
  141:     4099 20 08                                          BRA     NoCollision
  142:                                 
  143:     409B                        Collision:              
  144:                                                         
  145:     409B CD 1000                                        LDY     #msgObstacleY           ;output ObstacleY the message
  146:     409E 16 4045                                        JSR     putStr_sc0
  147:     40A1 20 06                                          BRA     Direction
  148:                                 
  149:                                                         
  150:     40A3                        NoCollision:
  151:     40A3 CD 1012                                        LDY     #msgObstacleN           ;output ObstacleN the message
  152:     40A6 16 4045                                        JSR     putStr_sc0                      
  153:                                 
  154:     40A9                        Direction:
  155:                                                         ;check to see what is in the first three bits in the LSB then branches to the appropriate location              
  156:     40A9 E6 8B                                          ldb     localProximity+1,sp
  157:     40AB C4 07                                          ANDB    #7
  158:     40AD C1 00                                          cmpb    #0
  159:     40AF 27 1C                                          BEQ     North
  160:     40B1 C1 01                                          cmpb    #1
  161:     40B3 27 30                                          BEQ     South
  162:     40B5 C1 02                                          cmpb    #2
  163:     40B7 27 1C                                          BEQ     East
  164:     40B9 C1 03                                          cmpb    #3
  165:     40BB 27 20                                          BEQ     West
  166:     40BD C1 04                                          cmpb    #4
  167:     40BF 27 2C                                          BEQ     NorthEast
  168:     40C1 C1 05                                          cmpb    #5
  169:     40C3 27 30                                          BEQ     NorthWest
  170:     40C5 C1 06                                          cmpb    #6
  171:     40C7 27 34                                          BEQ     SouthEast
  172:     40C9 C1 07                                          cmpb    #7
  173:     40CB 27 38                                          BEQ     SouthWest
  174:     40CD                        North:
  175:     40CD CD 1027                                        LDY     #msgNorth               ;output North the message
  176:     40D0 16 4045                                        JSR     putStr_sc0
  177:     40D3 20 36                                          BRA     KeysPressedDisp
  178:                                 
  179:     40D5                        East:
  180:     40D5 CD 1051                                        LDY     #msgEast                ;output East the message
  181:     40D8 16 4045                                        JSR     putStr_sc0
  182:     40DB 20 2E                                          BRA     KeysPressedDisp
  183:                                 
  184:     40DD                        West:
  185:     40DD CD 1066                                        LDY     #msgWest                ;output West the message
  186:     40E0 16 4045                                        JSR     putStr_sc0
  187:     40E3 20 26                                          BRA     KeysPressedDisp
  188:                                 
  189:     40E5                        South:
  190:     40E5 CD 103C                                        LDY     #msgSouth               ;output South the message
  191:     40E8 16 4045                                        JSR     putStr_sc0
  192:     40EB 20 1E                                          BRA     KeysPressedDisp
  193:                                 
  194:     40ED                        NorthEast:
  195:     40ED CD 107B                                        LDY     #msgNorthEast           ;output NorthEast the message
  196:     40F0 16 4045                                        JSR     putStr_sc0
  197:     40F3 20 16                                          BRA     KeysPressedDisp
  198:                                 
  199:     40F5                        NorthWest:
  200:     40F5 CD 1095                                        LDY     #msgNorthWest           ;output Nothwest the message
  201:     40F8 16 4045                                        JSR     putStr_sc0
  202:     40FB 20 0E                                          BRA     KeysPressedDisp
  203:                                 
  204:     40FD                        SouthEast:
  205:     40FD CD 10AF                                        LDY     #msgSouthEast           ;output Southeast the message
  206:     4100 16 4045                                        JSR     putStr_sc0
  207:     4103 20 06                                          BRA     KeysPressedDisp
  208:                                 
  209:     4105                        SouthWest:
  210:     4105 CD 10C9                                        LDY     #msgSouthWest           ;output Southwest the message
  211:     4108 16 4045                                        JSR     putStr_sc0
  212:                                 
  213:     410B                        KeysPressedDisp:
  214:                                                         ;loads the value of keyspressed by dereferencing the address on the stack then calls display
  215:     410B C6 10                                          ldb     #16
  216:     410D 7B 10E3                                        stab    counter
  217:     4110 F6 10E5                                        ldb     copycounter2
  218:     4113 CD 1121                                        ldy     #KeyPressedStr  
  219:     4116 19ED                                           ABY     
  220:     4118 EC F3 000C                                     ldd     [localKeys,sp]
  221:     411C 16 413B                                        jsr     Display
  222:                                 
  223:                                 
  224:     411F                        endDisplaySystemStatus: 
  225:     411F 31                                             puly
  226:     4120 30                                             pulx
  227:     4121 3A                                             puld
  228:                                 
  229:     4122 CC 001A                                        LDD     #BAUD19K                ;program SCI0's baud rate
  230:     4125 16 4038                                        JSR     setbaud
  231:                                                 
  232:     4128 CD 10E7                                        LDY     #msgSpeed               ;output Speed the message
  233:     412B 16 4045                                        JSR     putStr_sc0
  234:                                 
  235:     412E CD 10F6                                        LDY     #msgTemp                ;output Temp the message
  236:     4131 16 4045                                        JSR     putStr_sc0
  237:                                 
  238:                                 
  239:     4134 CD 1116                                        LDY     #msgKeys                ;output Keys the message
  240:     4137 16 4045                                        JSR     putStr_sc0              
  241:     413A 3D                                             rts
  242:                                 
  243:                                 
  244:                                 
  245:                                 ;**********************************************
  246:                                 ;Displays bits in binary by taking the hex
  247:                                 ;value and shifting it. Then it checks the carry
  248:                                 ;if carry is one then add a "1" to the array
  249:                                 ;add "0" to the array
  250:                                 ;**********************************************
  251:                                 
  252:     413B                        Display:
  253:     413B 49                                             LSRD    ;shifts d to get the bits into the carry
  254:     413C B7C5                                           XGDX    ;exchanges x and d so that it can load $31 into b
  255:     413E 25 02                                          BCS     One     ;if carry is one then print "1"
  256:     4140 24 13                                          BCC     Zero    ;if carry is zero then print "0"
  257:                                 
  258:     4142                        One:
  259:                                                         ;Stores 1 in to the array.
  260:     4142 C6 31                                          ldab    #$31
  261:     4144 6B 7F                                          stab    1,Y-
  262:     4146 73 10E3                                        DEC     Counter  ;decrement the counter 
  263:     4149 F6 10E3                                        ldab    Counter
  264:     414C F1 10E6                                        CMPB    Compare
  265:     414F B7C5                                           XGDX
  266:     4151 26 E8                                          BNE     Display
  267:     4153 20 13                                          BRA     programEnd
  268:                                                 
  269:                                                 
  270:     4155                        Zero:
  271:                                                         ;Stores "0" into the arry
  272:     4155 C6 30                                          ldab    #$30
  273:     4157 6B 7F                                          stab    1,Y-
  274:     4159 73 10E3                                        DEC     Counter
  275:     415C F6 10E3                                        ldab    Counter
  276:     415F F1 10E6                                        CMPB    Compare
  277:     4162 B7C5                                           XGDX
  278:     4164 26 D5                                          BNE     Display
  279:     4166 20 00                                          BRA     programEnd
  280:                                 
  281:                                 
  282:     4168                        programEnd:
  283:     4168 3D                                             rts     
  284:                                 
  285:                                 
  286:                                 
  287:                                 
  288:                                                 END

Symbols:
baud19k                         *0000001a
collision                       *0000409b
compare                         *000010e6
copycounter1                    *000010e4
copycounter2                    *000010e5
counter                         *000010e3
direction                       *000040a9
display                         *0000413b
displaysystemstatus             *00004064
doneputstr                      *00004054
east                            *000040d5
getchar_sc0                     *0000405d
keypressed                      *00001136
keypressedstr                   *00001121
keyspresseddisp                 *0000410b
localkeys                       *0000000c
localproximity                  *0000000a
localspeed                      *00000008
localtemperature                *00000009
msgeast                         *00001051
msgkeys                         *00001116
msgnorth                        *00001027
msgnortheast                    *0000107b
msgnorthwest                    *00001095
msgobstaclen                    *00001012
msgobstacley                    *00001000
msgprox                         *0000110b
msgsouth                        *0000103c
msgsoutheast                    *000010af
msgsouthwest                    *000010c9
msgspeed                        *000010e7
msgtemp                         *000010f6
msgwest                         *00001066
nocollision                     *000040a3
north                           *000040cd
northeast                       *000040ed
northwest                       *000040f5
one                             *00004142
programend                      *00004168
proximity                       *00001134
putchar_sc0                     *00004056
putstr                          *00004048
putstr_sc0                      *00004045
regbs                           *00000000
sc0bdh                          *000000c8
sc0bdl                          *000000c9
sc0cr1                          *000000ca
sc0cr2                          *000000cb
sc0drl                          *000000cf
sc0sr1                          *000000cc
setbaud                         *00004038
south                           *000040e5
southeast                       *000040fd
southwest                       *00004105
speed                           *00001132
speedstr                        *000010ed
temperature                     *00001133
temperaturestr                  *00001102
west                            *000040dd
zero                            *00004155

