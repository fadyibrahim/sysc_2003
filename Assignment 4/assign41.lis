                        .module Assign41.C
                        .area text
 0000                   .dbfile Assign41.C
 0000                   .dbfunc e main _main fV
 0000           _main::
 0000                   .dbline -1
 0000                   .dbline 9
 0000           ; /*
 0000           ; Authors Fady Ibrahim 100876906, Gavez Smith 100857991 
 0000           ; */
 0000           ; #include "hcs12dp256.h"
 0000           ; 
 0000           ; 
 0000           ; void printKeysPressed();
 0000           ; 
 0000           ; void main(){
 0000                   .dbline 12
 0000           ; 
 0000           ;        
 0000           ;        printKeysPressed();
 0000 160004            jsr _printKeysPressed
 0003                   .dbline -2
 0003                   .dbline 15
 0003           ; 
 0003           ;       
 0003           ; }
 0003           L3:
 0003                   .dbline 0 ; func end
 0003 3D                rts
 0004                   .dbend
 0004                   .dbfunc e printKeysPressed _printKeysPressed fV
 0004           ;           loop -> -7,x
 0004           ;     keypressed -> -5,x
 0004           ;        counter -> -4,x
 0004           ;              i -> -2,x
 0004           _printKeysPressed::
 0004 34                pshx
 0005 B775              tfr s,x
 0007 1B98              leas -8,sp
 0009                   .dbline -1
 0009                   .dbline 21
 0009           ; 
 0009           ; /*
 0009           ; printKeysPressed gets the character pressed on the keyboard by pulling and then it prints out the value on the terminal.
 0009           ; 
 0009           ; */
 0009           ; void printKeysPressed(){
 0009                   .dbline 22
 0009           ;       int i=0;
 0009 CC0000            ldd #0
 000C 6C1E              std -2,x
 000E                   .dbline 23
 000E           ;       int loop=0;
 000E CC0000            ldd #0
 0011 6C19              std -7,x
 0013                   .dbline 24
 0013           ;       char keypressed=0;
 0013 691B              clr -5,x
 0015                   .dbline 25
 0015           ;       int counter=1;
 0015 CC0001            ldd #1
 0018 6C1C              std -4,x
 001A                   .dbline 26
 001A           ;       SPI1CR1=0x00;
 001A 7900F0            clr 0xf0
 001D                   .dbline 28
 001D           ; //enable the rows with 1. Also expect an output for PTP
 001D           ;       DDRP=0x0F;
 001D C60F              ldab #15
 001F 7B025A            stab 0x25a
 0022                   .dbline 30
 0022           ; //enable the colums with 0. Also expect an input for PTH
 0022           ;       DDRH=0x00;
 0022 790262            clr 0x262
 0025 182001C3          lbra L6
 0029           L5:
 0029                   .dbline 32
 0029           ;       while (loop==0)
 0029           ;       {
 0029                   .dbline 34
 0029           ; // enable the latch.
 0029           ;       PTM = 0x08;                                                             
 0029 C608              ldab #8
 002B 7B0250            stab 0x250
 002E                   .dbline 35
 002E           ;       PTP=counter;
 002E EC1C              ldd -4,x
 0030 7B0258            stab 0x258
 0033                   .dbline 37
 0033           ; //get the input value from PTH
 0033           ;       keypressed=PTH;
 0033                   ; vol
 0033 F60260            ldab 0x260
 0036 6B1B              stab -5,x
 0038                   .dbline 38
 0038           ;       PTM &= 0x00;
 0038 CC0000            ldd #0
 003B 7B0250            stab 0x250
 003E                   .dbline 39
 003E           ;       keypressed &= 0xF0;
 003E 0D1B0F            bclr -5,x,#0xf
 0041                   .dbline 40
 0041           ;       if (keypressed==0x10 && counter==1)
 0041 E61B              ldab -5,x
 0043 C110              cmpb #16
 0045 2611              bne L8
 0047 EC1C              ldd -4,x
 0049 8C0001            cpd #1
 004C 260A              bne L8
 004E                   .dbline 41
 004E           ;       {
 004E                   .dbline 42
 004E           ;          printf("1" );
 004E CC0214            ldd #L10
 0051 160000            jsr _printf
 0054                   .dbline 43
 0054           ;       }
 0054 18200150          lbra L9
 0058           L8:
 0058                   .dbline 44
 0058           ;       else if (keypressed==0x20 && counter==1)
 0058 E61B              ldab -5,x
 005A C120              cmpb #32
 005C 2611              bne L11
 005E EC1C              ldd -4,x
 0060 8C0001            cpd #1
 0063 260A              bne L11
 0065                   .dbline 45
 0065           ;       {
 0065                   .dbline 46
 0065           ;          printf("2" );
 0065 CC0212            ldd #L13
 0068 160000            jsr _printf
 006B                   .dbline 47
 006B           ;       }
 006B 18200139          lbra L12
 006F           L11:
 006F                   .dbline 48
 006F           ;       else if (keypressed==0x40 && counter==1)
 006F E61B              ldab -5,x
 0071 C140              cmpb #64
 0073 2611              bne L14
 0075 EC1C              ldd -4,x
 0077 8C0001            cpd #1
 007A 260A              bne L14
 007C                   .dbline 49
 007C           ;       {
 007C                   .dbline 50
 007C           ;          printf("3" );
 007C CC0210            ldd #L16
 007F 160000            jsr _printf
 0082                   .dbline 51
 0082           ;       }
 0082 18200122          lbra L15
 0086           L14:
 0086                   .dbline 52
 0086           ;       else if (keypressed==0x80 && counter==1)
 0086 E61B              ldab -5,x
 0088 C180              cmpb #128
 008A 2611              bne L17
 008C EC1C              ldd -4,x
 008E 8C0001            cpd #1
 0091 260A              bne L17
 0093                   .dbline 53
 0093           ;       {
 0093                   .dbline 54
 0093           ;          printf("A");
 0093 CC020E            ldd #L19
 0096 160000            jsr _printf
 0099                   .dbline 55
 0099           ;       }
 0099 1820010B          lbra L18
 009D           L17:
 009D                   .dbline 56
 009D           ;       else if (keypressed==0x10 && counter==2)
 009D E61B              ldab -5,x
 009F C110              cmpb #16
 00A1 2611              bne L20
 00A3 EC1C              ldd -4,x
 00A5 8C0002            cpd #2
 00A8 260A              bne L20
 00AA                   .dbline 57
 00AA           ;       {
 00AA                   .dbline 58
 00AA           ;          printf("4");
 00AA CC020C            ldd #L22
 00AD 160000            jsr _printf
 00B0                   .dbline 59
 00B0           ;       }
 00B0 182000F4          lbra L21
 00B4           L20:
 00B4                   .dbline 60
 00B4           ;               else if (keypressed==0x20 && counter==2)
 00B4 E61B              ldab -5,x
 00B6 C120              cmpb #32
 00B8 2611              bne L23
 00BA EC1C              ldd -4,x
 00BC 8C0002            cpd #2
 00BF 260A              bne L23
 00C1                   .dbline 61
 00C1           ;       {
 00C1                   .dbline 62
 00C1           ;          printf("5");
 00C1 CC020A            ldd #L25
 00C4 160000            jsr _printf
 00C7                   .dbline 63
 00C7           ;       }
 00C7 182000DD          lbra L24
 00CB           L23:
 00CB                   .dbline 64
 00CB           ;               else if (keypressed==0x40 && counter==2)
 00CB E61B              ldab -5,x
 00CD C140              cmpb #64
 00CF 2611              bne L26
 00D1 EC1C              ldd -4,x
 00D3 8C0002            cpd #2
 00D6 260A              bne L26
 00D8                   .dbline 65
 00D8           ;       {
 00D8                   .dbline 66
 00D8           ;          printf("6");
 00D8 CC0208            ldd #L28
 00DB 160000            jsr _printf
 00DE                   .dbline 67
 00DE           ;       }
 00DE 182000C6          lbra L27
 00E2           L26:
 00E2                   .dbline 68
 00E2           ;               else if (keypressed==0x80 && counter==2)
 00E2 E61B              ldab -5,x
 00E4 C180              cmpb #128
 00E6 2611              bne L29
 00E8 EC1C              ldd -4,x
 00EA 8C0002            cpd #2
 00ED 260A              bne L29
 00EF                   .dbline 69
 00EF           ;       {
 00EF                   .dbline 70
 00EF           ;          printf("B");
 00EF CC0206            ldd #L31
 00F2 160000            jsr _printf
 00F5                   .dbline 71
 00F5           ;       }
 00F5 182000AF          lbra L30
 00F9           L29:
 00F9                   .dbline 73
 00F9           ;       
 00F9           ;               else if (keypressed==0x10 && counter==4)
 00F9 E61B              ldab -5,x
 00FB C110              cmpb #16
 00FD 2611              bne L32
 00FF EC1C              ldd -4,x
 0101 8C0004            cpd #4
 0104 260A              bne L32
 0106                   .dbline 74
 0106           ;       {
 0106                   .dbline 75
 0106           ;          printf("7");
 0106 CC0204            ldd #L34
 0109 160000            jsr _printf
 010C                   .dbline 76
 010C           ;       }
 010C 18200098          lbra L33
 0110           L32:
 0110                   .dbline 77
 0110           ;               else if (keypressed==0x20 && counter==4)
 0110 E61B              ldab -5,x
 0112 C120              cmpb #32
 0114 2611              bne L35
 0116 EC1C              ldd -4,x
 0118 8C0004            cpd #4
 011B 260A              bne L35
 011D                   .dbline 78
 011D           ;       {
 011D                   .dbline 79
 011D           ;          printf("8");
 011D CC0202            ldd #L37
 0120 160000            jsr _printf
 0123                   .dbline 80
 0123           ;       }
 0123 18200081          lbra L36
 0127           L35:
 0127                   .dbline 81
 0127           ;               else if (keypressed==0x40 && counter==4)
 0127 E61B              ldab -5,x
 0129 C140              cmpb #64
 012B 260F              bne L38
 012D EC1C              ldd -4,x
 012F 8C0004            cpd #4
 0132 2608              bne L38
 0134                   .dbline 82
 0134           ;       {
 0134                   .dbline 83
 0134           ;          printf("9");
 0134 CC0200            ldd #L40
 0137 160000            jsr _printf
 013A                   .dbline 84
 013A           ;       }
 013A 206C              bra L39
 013C           L38:
 013C                   .dbline 85
 013C           ;               else if (keypressed==0x80 && counter==4)
 013C E61B              ldab -5,x
 013E C180              cmpb #128
 0140 260F              bne L41
 0142 EC1C              ldd -4,x
 0144 8C0004            cpd #4
 0147 2608              bne L41
 0149                   .dbline 86
 0149           ;       {
 0149                   .dbline 87
 0149           ;          printf("C");
 0149 CC01FE            ldd #L43
 014C 160000            jsr _printf
 014F                   .dbline 88
 014F           ;       }
 014F 2057              bra L42
 0151           L41:
 0151                   .dbline 90
 0151           ;       
 0151           ;               else if (keypressed==0x10 && counter==8)
 0151 E61B              ldab -5,x
 0153 C110              cmpb #16
 0155 260F              bne L44
 0157 EC1C              ldd -4,x
 0159 8C0008            cpd #8
 015C 2608              bne L44
 015E                   .dbline 91
 015E           ;       {
 015E                   .dbline 92
 015E           ;          printf("E");
 015E CC01FC            ldd #L46
 0161 160000            jsr _printf
 0164                   .dbline 93
 0164           ;       }
 0164 2042              bra L45
 0166           L44:
 0166                   .dbline 94
 0166           ;               else if (keypressed==0x20 && counter==8)
 0166 E61B              ldab -5,x
 0168 C120              cmpb #32
 016A 2614              bne L47
 016C EC1C              ldd -4,x
 016E 8C0008            cpd #8
 0171 260D              bne L47
 0173                   .dbline 95
 0173           ;       {
 0173                   .dbline 96
 0173           ;          printf("0");
 0173 CC01FA            ldd #L49
 0176 160000            jsr _printf
 0179                   .dbline 97
 0179           ;          loop=1;
 0179 CC0001            ldd #1
 017C 6C19              std -7,x
 017E                   .dbline 98
 017E           ;       }
 017E 2028              bra L48
 0180           L47:
 0180                   .dbline 99
 0180           ;               else if (keypressed==0x40 && counter==8)
 0180 E61B              ldab -5,x
 0182 C140              cmpb #64
 0184 260F              bne L50
 0186 EC1C              ldd -4,x
 0188 8C0008            cpd #8
 018B 2608              bne L50
 018D                   .dbline 100
 018D           ;       {
 018D                   .dbline 101
 018D           ;          printf("F");
 018D CC01F8            ldd #L52
 0190 160000            jsr _printf
 0193                   .dbline 102
 0193           ;       }
 0193 2013              bra L51
 0195           L50:
 0195                   .dbline 103
 0195           ;               else if (keypressed==0x80 && counter==8)
 0195 E61B              ldab -5,x
 0197 C180              cmpb #128
 0199 260D              bne L53
 019B EC1C              ldd -4,x
 019D 8C0008            cpd #8
 01A0 2606              bne L53
 01A2                   .dbline 104
 01A2           ;       {
 01A2                   .dbline 105
 01A2           ;          printf("D");
 01A2 CC01F6            ldd #L55
 01A5 160000            jsr _printf
 01A8                   .dbline 106
 01A8           ;       }
 01A8           L53:
 01A8           L51:
 01A8           L48:
 01A8           L45:
 01A8           L42:
 01A8           L39:
 01A8           L36:
 01A8           L33:
 01A8           L30:
 01A8           L27:
 01A8           L24:
 01A8           L21:
 01A8           L18:
 01A8           L15:
 01A8           L12:
 01A8           L9:
 01A8                   .dbline 108
 01A8 CC0000            ldd #0
 01AB 6C1E              std -2,x
 01AD           L56:
 01AD                   .dbline 108
 01AD           L57:
 01AD                   .dbline 108
 01AD           ;       //delay so that 1 character can get displayed at a time
 01AD           ;       for ( i=0;i<10000;i++);
 01AD EC1E              ldd -2,x
 01AF C30001            addd #1
 01B2 6C1E              std -2,x
 01B4                   .dbline 108
 01B4 EC1E              ldd -2,x
 01B6 8C2710            cpd #10000
 01B9 2DF2              blt L56
 01BB                   .dbline 111
 01BB           ; 
 01BB           ;       //increament the counter and make sure it stays on 1,2,4,8 to set rows 1,2,3,4
 01BB           ;       if(counter>=2)
 01BB EC1C              ldd -4,x
 01BD 8C0002            cpd #2
 01C0 2D09              blt L60
 01C2                   .dbline 112
 01C2           ;       {
 01C2                   .dbline 113
 01C2           ;       counter=counter +2;
 01C2 EC1C              ldd -4,x
 01C4 C30002            addd #2
 01C7 6C1C              std -4,x
 01C9                   .dbline 114
 01C9           ;       }
 01C9 2007              bra L61
 01CB           L60:
 01CB                   .dbline 116
 01CB           ;       else
 01CB           ;       {
 01CB                   .dbline 117
 01CB           ;       counter++;
 01CB EC1C              ldd -4,x
 01CD C30001            addd #1
 01D0 6C1C              std -4,x
 01D2                   .dbline 118
 01D2           ;       }
 01D2           L61:
 01D2                   .dbline 119
 01D2           ;       if (counter==6)
 01D2 EC1C              ldd -4,x
 01D4 8C0006            cpd #6
 01D7 2607              bne L62
 01D9                   .dbline 120
 01D9           ;       {
 01D9                   .dbline 121
 01D9           ;       counter=counter+2;
 01D9 EC1C              ldd -4,x
 01DB C30002            addd #2
 01DE 6C1C              std -4,x
 01E0                   .dbline 122
 01E0           ;       }
 01E0           L62:
 01E0                   .dbline 123
 01E0           ;       if (counter>8)
 01E0 EC1C              ldd -4,x
 01E2 8C0008            cpd #8
 01E5 2F05              ble L64
 01E7                   .dbline 124
 01E7           ;       {
 01E7                   .dbline 125
 01E7           ;       counter=1;
 01E7 CC0001            ldd #1
 01EA 6C1C              std -4,x
 01EC                   .dbline 126
 01EC           ;       }
 01EC           L64:
 01EC                   .dbline 127
 01EC           L6:
 01EC                   .dbline 31
 01EC EC19              ldd -7,x
 01EE 1827FE37          lbeq L5
 01F2                   .dbline -2
 01F2                   .dbline 128
 01F2           ;       }
 01F2           ; }
 01F2           L4:
 01F2 B757              tfr x,s
 01F4 30                pulx
 01F5                   .dbline 0 ; func end
 01F5 3D                rts
 01F6                   .dbsym l loop -7 I
 01F6                   .dbsym l keypressed -5 c
 01F6                   .dbsym l counter -4 I
 01F6                   .dbsym l i -2 I
 01F6                   .dbend
 01F6           L55:
 01F6 4400              .byte 'D,0
 01F8           L52:
 01F8 4600              .byte 'F,0
 01FA           L49:
 01FA 3000              .byte 48,0
 01FC           L46:
 01FC 4500              .byte 'E,0
 01FE           L43:
 01FE 4300              .byte 'C,0
 0200           L40:
 0200 3900              .byte 57,0
 0202           L37:
 0202 3800              .byte 56,0
 0204           L34:
 0204 3700              .byte 55,0
 0206           L31:
 0206 4200              .byte 'B,0
 0208           L28:
 0208 3600              .byte 54,0
 020A           L25:
 020A 3500              .byte 53,0
 020C           L22:
 020C 3400              .byte 52,0
 020E           L19:
 020E 4100              .byte 'A,0
 0210           L16:
 0210 3300              .byte 51,0
 0212           L13:
 0212 3200              .byte 50,0
 0214           L10:
 0214 3100              .byte 49,0
